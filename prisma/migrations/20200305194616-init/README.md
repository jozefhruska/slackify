# Migration `20200305194616-init`

This migration has been generated by Jozef Hru≈°ka at 3/5/2020, 7:46:16 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
    "accessToken" text  NOT NULL DEFAULT '',
    "email" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "team" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Collection" (
    "handle" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "team" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Team" (
    "accessToken" text  NOT NULL DEFAULT '',
    "domain" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Post" (
    "author" text  NOT NULL ,
    "collection" text  NOT NULL ,
    "content" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "isPublished" boolean  NOT NULL DEFAULT false,
    "short" text  NOT NULL DEFAULT '',
    "title" text  NOT NULL DEFAULT '',
    "type" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "User.accessToken" ON "public"."User"("accessToken")

CREATE UNIQUE INDEX "Team.domain" ON "public"."Team"("domain")

CREATE UNIQUE INDEX "Team.accessToken" ON "public"."Team"("accessToken")

ALTER TABLE "public"."User" ADD FOREIGN KEY ("team")REFERENCES "public"."Team"("id") ON DELETE RESTRICT  ON UPDATE CASCADE

ALTER TABLE "public"."Collection" ADD FOREIGN KEY ("team")REFERENCES "public"."Team"("id") ON DELETE RESTRICT  ON UPDATE CASCADE

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("author")REFERENCES "public"."User"("id") ON DELETE RESTRICT  ON UPDATE CASCADE

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("collection")REFERENCES "public"."Collection"("id") ON DELETE RESTRICT  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200305194616-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,61 @@
+datasource db {
+  provider = "postgresql"
+  url      = env("POSTGRES_URL")
+  enabled  = env("POSTGRES_URL")
+  // url      = "postgresql://postgres:password@localhost:5432/postgres"
+}
+
+generator cient_prisma {
+  provider = "prisma-client-js"
+}
+
+generator cient_service_slack {
+  provider = "prisma-client-js"
+  output   = "../service-slack/node_modules/@prisma/client"
+}
+
+generator client_service_private {
+  provider = "prisma-client-js"
+  output   = "../service-private/node_modules/@prisma/client"
+}
+
+generator client_service_public {
+  provider = "prisma-client-js"
+  output   = "../service-public/node_modules/@prisma/client"
+}
+
+model User {
+  id          String @id
+  email       String @unique
+  name        String
+  accessToken String @unique
+  team        Team
+  posts       Post[]
+}
+
+model Collection {
+  id     String @default(cuid()) @id
+  handle String
+  team   Team
+  posts  Post[]
+}
+
+model Team {
+  id          String @id
+  name        String 
+  domain      String @unique
+  accessToken String @unique
+}
+
+model Post {
+  id          String   @default(cuid()) @id
+  type        String
+  title       String
+  short       String
+  content     String?
+  isPublished Boolean
+  collection    Collection
+  author      User
+  createdAt   DateTime @default(now())
+  updatedAt   DateTime @updatedAt
+}
```


