# Migration `20200315185351-add-missing-relations-to-component-data-models`

This migration has been generated by Jozef Hru≈°ka at 3/15/2020, 6:53:51 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Component" ADD COLUMN "linkData" text   ,
ADD COLUMN "plainTextData" text   ;

CREATE UNIQUE INDEX "ArticleComponentData_component" ON "public"."ArticleComponentData"("component")

ALTER TABLE "public"."Component" ADD FOREIGN KEY ("plainTextData")REFERENCES "public"."PlainTextComponentData"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Component" ADD FOREIGN KEY ("linkData")REFERENCES "public"."LinkComponentData"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200315184121-split-component-types..20200315185351-add-missing-relations-to-component-data-models
--- datamodel.dml
+++ datamodel.dml
@@ -1,9 +1,9 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRES_URL")
   enabled  = env("POSTGRES_URL")
-  // url = "***"
+  // url      = "postgresql://postgres:password@localhost:5432/postgres"
 }
 generator cient_prisma {
   provider = "prisma-client-js"
@@ -56,15 +56,18 @@
   collections Collection[]
 }
 model Component {
-  id         String        @default(cuid()) @id
-  type       ComponentType @default(ARTICLE)
-  published  Boolean       @default(false)
-  collection Collection
-  author     User
-  createdAt  DateTime      @default(now())
-  updatedAt  DateTime      @updatedAt
+  id            String                  @default(cuid()) @id
+  type          ComponentType           @default(ARTICLE)
+  published     Boolean                 @default(false)
+  collection    Collection
+  author        User
+  plainTextData PlainTextComponentData?
+  articleData   ArticleComponentData?
+  linkData      LinkComponentData?
+  createdAt     DateTime                @default(now())
+  updatedAt     DateTime                @updatedAt
 }
 model PlainTextComponentData {
   id   String @default(cuid()) @id
```


