# Migration `20200320190327-add-missing-url-field-to-link-data-model`

This migration has been generated by Jozef Hru≈°ka at 3/20/2020, 7:03:27 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."ArticleComponentData_component"

ALTER TABLE "public"."ArticleComponentData" DROP CONSTRAINT IF EXiSTS "ArticleComponentData_component_fkey",
DROP COLUMN "component";

ALTER TABLE "public"."Component" ADD COLUMN "articleData" text   ;

ALTER TABLE "public"."LinkComponentData" ADD COLUMN "url" text  NOT NULL DEFAULT '',
ALTER COLUMN "text" DROP NOT NULL,
ALTER COLUMN "text" DROP DEFAULT;

ALTER TABLE "public"."Component" ADD FOREIGN KEY ("articleData")REFERENCES "public"."ArticleComponentData"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200317204207-add-type-to-collection-model..20200320190327-add-missing-url-field-to-link-data-model
--- datamodel.dml
+++ datamodel.dml
@@ -1,9 +1,9 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRES_URL")
   enabled  = env("POSTGRES_URL")
-  // url = "***"
+  // url      = "postgresql://postgres:password@localhost:5432/postgres"
 }
 generator cient_prisma {
   provider = "prisma-client-js"
@@ -80,14 +80,14 @@
   id        String    @default(cuid()) @id
   title     String
   lead      String
   content   String?
-  component Component
 }
 model LinkComponentData {
   id   String @default(cuid()) @id
-  text String
+  text String?
+  url  String
 }
 enum ComponentType {
   PLAIN_TEXT ARTICLE LINK
```


