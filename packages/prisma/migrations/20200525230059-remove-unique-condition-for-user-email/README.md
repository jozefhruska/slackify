# Migration `20200525230059-remove-unique-condition-for-user-email`

This migration has been generated by Jozef Hru≈°ka at 5/25/2020, 11:01:00 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."User.email"

ALTER TABLE "public"."ArticleComponentData" DROP CONSTRAINT IF EXiSTS "ArticleComponentData_componentId_fkey";

ALTER TABLE "public"."LinkComponentData" DROP CONSTRAINT IF EXiSTS "LinkComponentData_componentId_fkey";

ALTER TABLE "public"."PlainTextComponentData" DROP CONSTRAINT IF EXiSTS "PlainTextComponentData_componentId_fkey";

ALTER TABLE "public"."StatRecord" DROP CONSTRAINT IF EXiSTS "StatRecord_componentId_fkey";

ALTER TABLE "public"."ArticleComponentData" ADD FOREIGN KEY ("componentId")REFERENCES "public"."Component"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."LinkComponentData" ADD FOREIGN KEY ("componentId")REFERENCES "public"."Component"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."PlainTextComponentData" ADD FOREIGN KEY ("componentId")REFERENCES "public"."Component"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."StatRecord" ADD FOREIGN KEY ("componentId")REFERENCES "public"."Component"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200525194002-add-special-id-to-user-model..20200525230059-remove-unique-condition-for-user-email
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
   enabled  = env("DATABASE_URL")
 }
 generator cient_common {
@@ -11,9 +11,9 @@
 model User {
   id          String      @default(cuid()) @id
   slackId     String
-  email       String      @unique
+  email       String
   name        String
   role        UserRole    @default(VIEWER)
   accessToken String      @unique
   avatar      String?
```


